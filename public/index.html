<!DOCTYPE html>
<html lang="en">
  <head>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.4.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.4.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="../css/global.css" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.5" />
    <title>Login / Registracija</title>
  </head>
  <body>
    <h1 class="text-center">AGENOR - BAZENI</h1>

    <div class="container mt-5">
      <h2>Prijava</h2>
      <input
        id="email"
        type="email"
        placeholder="Email"
        class="form-control mb-2"
      />
      <input
        id="password"
        type="password"
        placeholder="Lozinka"
        class="form-control mb-3"
      />
      <button class="btn btn-primary mb-5" onclick="login()">Login</button>

      <hr />

      <h2>Registracija</h2>
      <input
        id="reg-email"
        type="email"
        placeholder="Email"
        class="form-control mb-2"
      />
      <input
        id="reg-password"
        type="password"
        placeholder="Lozinka"
        class="form-control mb-2"
      />
      <input
        id="reg-phone"
        type="tel"
        placeholder="Broj telefona"
        class="form-control mb-2"
      />

      <select id="reg-group" class="form-select mb-3">
        <option value="" disabled selected>Odaberi grupu</option>
        <option value="A">Grupa A</option>
        <option value="B">Grupa B</option>
        <option value="C">Grupa C</option>
      </select>

      <button class="btn btn-success" onclick="signup()">Registriraj se</button>
    </div>

    <script>
      function login() {
        const email = document.getElementById("email").value;
        const password = document.getElementById("password").value;

        fetch("/", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({ email, password }),
        })
          .then((res) =>
            res.text().then((msg) => {
              if (res.ok) {
                alert(msg); // popup s porukom uspjeha
                window.location.href = "/menu";
              } else {
                alert(msg); // popup s porukom greške
              }
            })
          )
          .catch((err) => {
            console.error(err);
            alert("Greška prilikom slanja zahtjeva");
          });
      }

      function signup() {
        const email = document.getElementById("reg-email").value;
        const password = document.getElementById("reg-password").value;
        const phone = document.getElementById("reg-phone").value;
        const group = document.getElementById("reg-group").value;

        fetch("/signup", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({ email, password, phone, group }),
        })
          .then((res) => {
            if (res.ok) {
              alert("Registracija uspješna! Možete se prijaviti.");
            } else {
              res.text().then((msg) => alert(msg));
            }
          })
          .catch((err) => {
            console.error(err);
            alert("Greška prilikom registracije");
          });
      }
    </script>
  </body>
</html>
